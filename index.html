<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>London Roulette</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Helvetica, Arial, sans-serif, Geneva, Verdana, sans-serif;
      text-align: center;
      margin: 20px;
      background-color: #FFFFFF;
      color: #2C2C2C;
    }

    .page-content {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    a {
      color: #007bff;
      text-decoration: none;
    }

    h1 {
      color: #2C2C2C;
    }

    p {
      margin: 0 auto 20px;
    }

    .spin-container {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      margin: 30px 0;
      width: 100%;
    }

    .spin-stage {
      background-color: #fff;
      border: 1px solid #C8BDB1;
      padding: 20px;
      border-radius: 10px;
    }

    button {
      background-color: #D4AF37;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }

    button:hover:not(:disabled) {
      background-color: #c8a534;
    }

    button:disabled {
      background-color: #C8BDB1;
      cursor: not-allowed;
    }

    .result {
      font-size: 1.2em;
      font-weight: normal;
      margin-top: 10px;
      color: #003366;
      min-height: 1.5em;
    }

    #final-stations {
      margin-top: 40px;
      padding: 20px;
      border: 2px dashed #C8BDB1;
      border-radius: 15px;
      background-color: #F5F3EE;
    }

    .final-station-item {
      background: #FFFFFF;
      margin: 10px 0;
      font-size: 1.1em;
      color: #003366;
      cursor: pointer;
      padding: 10px;
      border-radius: 5px;
      transition: background-color 0.2s, box-shadow 0.2s;
      text-align: left;
      border: 1px solid #C8BDB1;
    }

    .final-station-item:hover {
      background-color: #F5F3EE;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .final-station-item.chosen {
      background-color: #28a745 !important;
      color: white !important;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
      border-color: #28a745;
    }

    #chosen-station-info {
      font-size: 1.1em;
      color: #2C2C2C;
      margin-top: 20px;
      padding: 15px;
      border: 2px solid #003366;
      display: inline-block;
      border-radius: 5px;
      text-align: left;
      width: 100%;
    }

    .lines-list {
      margin-top: 10px;
      padding-top: 10px;
    }

    .line-tag {
      display: inline-block;
      padding: 4px 8px;
      margin: 3px;
      border-radius: 12px;
      font-size: 0.9em;
      font-weight: bold;
      color: white;
      text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
      white-space: nowrap;
    }

    .quick-links {
      margin-top: 20px;
      padding-top: 10px;
      border-top: 1px dashed #003366;
    }

    .quick-links a {
      margin: 0 8px;
      text-decoration: none;
      font-weight: bold;
      color: #007bff;
      transition: color 0.2s;
    }

    .quick-links a:hover {
      color: #00478f;
    }

    /* Zone Filter Specific Styles */
    #zone-filter-container {
      margin-bottom: 30px;
      padding: 15px;
      background-color: #F5F3EE;
      border-radius: 8px;
      display: inline-block;
      width: 100%;
    }

    #zone-select {
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #C8BDB1;
      font-size: 16px;
      width: 60%;
    }

    #current-selection {
      margin-top: 10px;
      font-weight: bold;
      color: #28a745;
    }

    /* Line colors remain the same */
    .Bakerloo {
      background-color: #B36305;
    }

    .Central {
      background-color: #E32017;
    }

    .Circle {
      background-color: #FFD300;
      color: black !important;
      text-shadow: none !important;
    }

    .District {
      background-color: #00782A;
    }

    .HammersmithCity {
      background-color: #F3A9A8;
      color: black !important;
      text-shadow: none !important;
    }

    .Jubilee {
      background-color: #A0A5A9;
    }

    .Metropolitan {
      background-color: #9B0056;
    }

    .Northern {
      background-color: #000000;
    }

    .Piccadilly {
      background-color: #0036A5;
    }

    .Victoria {
      background-color: #0098D4;
    }

    .WaterlooCity {
      background-color: #99D1C0;
      color: black !important;
      text-shadow: none !important;
    }

    .DLR {
      background-color: #00A4A7;
    }

    .Overground {
      background-color: #EE7C0E;
    }

    .Elizabeth {
      background-color: #6950a1;
    }

    .Tramlink {
      background-color: #65BD53;
    }
  </style>
</head>

<body>
  <div class="page-content">
    <h1>🚇 London Station Roulette</h1>
    <p>
      Choose a place to go by spinning the wheel.
    </p>

    <div id="zone-filter-container">
      <h2>Which zones are you willing to travel to?</h2>
      <select id="zone-select" multiple onchange="updateSelectedZonesDisplay()">
        <option value="1" selected>Zone 1</option>
        <option value="2" selected>Zone 2</option>
        <option value="3" selected>Zone 3</option>
        <option value="4">Zone 4</option>
        <option value="5">Zone 5</option>
        <option value="6">Zone 6</option>
      </select>
      <p id="current-selection">Selected: Zone 1, Zone 2, Zone 3</p>
    </div>

    <div class="spin-container">
      <div class="spin-stage">
        <h2>Destination 1</h2>
        <div class="result" id="spin1-result">Ready to spin...</div>
        <button id="button-1" onclick="spinRoulette(1)">Spin</button>
      </div>

      <div class="spin-stage">
        <h2>Destination 2</h2>
        <div class="result" id="spin2-result">Ready to spin...</div>
        <button id="button-2" onclick="spinRoulette(2)">Spin</button>
      </div>

      <div class="spin-stage">
        <h2>Destination 3</h2>
        <div class="result" id="spin3-result">Ready to spin...</div>
        <button id="button-3" onclick="spinRoulette(3)">Spin</button>
      </div>
    </div>

    <h2>Your three destinations</h2>
    <div id="final-stations">
      <p>Spin all three wheels to give yourself some options.</p>
    </div>

    <h2>You're going to...</h2>
    <div id="chosen-station-info">Select a station above to confirm your destination.
    </div>
  </div>

  <script>
    // --- Station Data Mapped by Zone ---
    // Stations are now categorized by their main zone for filtering purposes.
    const ZONED_STATIONS = {
      '1': [
        { name: "Bank / Monument", lines: ["Central", "Northern", "WaterlooCity", "District", "Circle", "DLR"] },
        { name: "King's Cross St. Pancras", lines: ["Circle", "HammersmithCity", "Metropolitan", "Northern", "Piccadilly", "Victoria"] },
        { name: "Liverpool Street", lines: ["Central", "Circle", "HammersmithCity", "Metropolitan", "Elizabeth"] },
        { name: "Waterloo", lines: ["Bakerloo", "Jubilee", "Northern", "WaterlooCity"] },
        { name: "Victoria", lines: ["Circle", "District", "Victoria"] },
        { name: "Paddington", lines: ["Bakerloo", "Circle", "District", "HammersmithCity", "Elizabeth"] },
        { name: "Oxford Circus", lines: ["Bakerloo", "Central", "Victoria"] },
        { name: "Green Park", lines: ["Jubilee", "Piccadilly", "Victoria"] },
        { name: "Tottenham Court Road", lines: ["Central", "Northern", "Elizabeth"] },
        { name: "Angel", lines: ["Northern"] },
        { name: "Charing Cross", lines: ["Bakerloo", "Northern"] },
        { name: "Leicester Square", lines: ["Northern", "Piccadilly"] },
        { name: "Bond Street", lines: ["Central", "Jubilee", "Elizabeth"] },
        { name: "Battersea Power Station", lines: ["Northern"] },
        { name: "Tower Hill", lines: ["Circle", "District"] },
        // ... (Many more Zone 1 stations)
      ],
      '2': [
        { name: "Stratford", lines: ["Central", "Jubilee", "DLR", "Overground", "Elizabeth"] },
        { name: "Canada Water", lines: ["Jubilee", "Overground"] },
        { name: "Finsbury Park", lines: ["Piccadilly", "Victoria"] },
        { name: "Camden Town", lines: ["Northern"] },
        { name: "Canary Wharf", lines: ["Jubilee", "DLR", "Elizabeth"] },
        { name: "Brixton", lines: ["Victoria"] },
        { name: "Clapham Common", lines: ["Northern"] },
        { name: "Mile End", lines: ["Central", "District", "HammersmithCity"] },
        { name: "Shepherd's Bush", lines: ["Central", "Overground"] },
        { name: "Earl's Court", lines: ["District", "Piccadilly"] },
        { name: "North Greenwich", lines: ["Jubilee"] },
        { name: "Kensal Green", lines: ["Bakerloo", "Overground"] },
        { name: "Shoreditch High Street", lines: ["Overground"] },
        { name: "Wapping", lines: ["Overground"] },
        { name: "Clapham Junction", lines: ["Overground"] },
        // ... (Many more Zone 2 stations)
      ],
      '3': [
        { name: "Ealing Broadway", lines: ["Central", "District", "Elizabeth"] },
        { name: "Walthamstow Central", lines: ["Victoria", "Overground"] },
        { name: "Tottenham Hale", lines: ["Victoria", "Overground"] },
        { name: "Blackhorse Road", lines: ["Victoria", "Overground"] },
        { name: "Stockwell", lines: ["Northern", "Victoria"] },
        { name: "Balham", lines: ["Northern"] },
        { name: "New Cross Gate", lines: ["Overground"] },
        { name: "Custom House", lines: ["DLR", "Elizabeth"] },
        { name: "Greenwich", lines: ["DLR"] },
        { name: "Archway", lines: ["Northern"] },
        { name: "Ravenscourt Park", lines: ["District"] },
        { name: "Upney", lines: ["District"] },
        { name: "Leytonstone", lines: ["Central"] },
        // ... (Many more Zone 3 stations)
      ],
      '4': [
        { name: "Richmond", lines: ["District", "Overground"] },
        { name: "Harrow & Wealdstone", lines: ["Bakerloo", "Overground"] },
        { name: "Arnos Grove", lines: ["Piccadilly"] },
        { name: "Stanmore", lines: ["Jubilee"] },
        { name: "Hounslow Central", lines: ["Piccadilly"] },
        { name: "East Ham", lines: ["District", "HammersmithCity"] },
        { name: "Hillingdon", lines: ["Metropolitan", "Piccadilly"] },
        { name: "Wembley Central", lines: ["Bakerloo", "Overground"] },
        { name: "Woolwich Arsenal", lines: ["DLR", "Elizabeth"] },
        // ... (Many more Zone 4 stations)
      ],
      '5': [
        { name: "Epping", lines: ["Central"] },
        { name: "West Ruislip", lines: ["Central"] },
        { name: "Heathrow Terminals 2 & 3", lines: ["Piccadilly", "Elizabeth"] },
        { name: "Dagenham Heathway", lines: ["District"] },
        { name: "Pinner", lines: ["Metropolitan"] },
        { name: "Hornchurch", lines: ["District"] },
        { name: "East Croydon", lines: ["Tramlink"] },
        { name: "Mitcham Junction", lines: ["Tramlink"] },
        // ... (Many more Zone 5 stations)
      ],
      '6': [
        { name: "Upminster", lines: ["District"] },
        { name: "Cockfosters", lines: ["Piccadilly"] },
        { name: "Uxbridge", lines: ["Metropolitan", "Piccadilly"] },
        { name: "Amersham", lines: ["Metropolitan"] },
        { name: "Chesham", lines: ["Metropolitan"] },
        { name: "Moor Park", lines: ["Metropolitan"] },
        { name: "Ruislip", lines: ["Metropolitan", "Piccadilly"] },
        // Note: Zones 7-9 stations are mapped to Zone 6 for simplification.
      ]
    };

    // Storage for the three results
    let finalResults = {};

    // --- Filtering Functions ---

    /**
     * Updates the display of currently selected zones.
     */
    function updateSelectedZonesDisplay() {
      const select = document.getElementById('zone-select');
      const selectedOptions = Array.from(select.selectedOptions).map(option => option.text);
      const display = document.getElementById('current-selection');

      if (selectedOptions.length === 0) {
        display.textContent = 'Selected: No Zones (Spinning is disabled)';
      } else {
        display.textContent = 'Selected: ' + selectedOptions.join(', ');
      }
    }

    /**
     * Gets the filtered list of stations based on the dropdown selection.
     * @returns {Array} A flat array of station objects from the selected zones.
     */
    function getFilteredStations() {
      const select = document.getElementById('zone-select');
      const selectedZones = Array.from(select.selectedOptions).map(option => option.value);

      let filteredStations = [];

      if (selectedZones.length === 0) {
        return []; // Return empty if no zones selected
      }

      selectedZones.forEach(zone => {
        if (ZONED_STATIONS[zone]) {
          filteredStations.push(...ZONED_STATIONS[zone]);
        }
      });

      return filteredStations;
    }


    // --- Core Functions ---

    function getRandomStation(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function spinRoulette(spinNumber) {
      const stationsPool = getFilteredStations();

      if (stationsPool.length === 0) {
        alert("Please select at least one zone before spinning!");
        return;
      }

      const resultElement = document.getElementById(`spin${spinNumber}-result`);
      const button = document.getElementById(`button-${spinNumber}`);

      // Disable all spin buttons during the spin animation
      document.querySelectorAll('button').forEach(btn => btn.disabled = true);
      button.textContent = 'Spinning...';

      let currentStationName;

      // Simple visual "spin" effect over 1.5 seconds
      const spinInterval = setInterval(() => {
        currentStationName = getRandomStation(stationsPool).name;
        resultElement.textContent = `🔄 ${currentStationName}`;
      }, 100);

      // Stop the spin and select the final station after 1.5 seconds
      setTimeout(() => {
        clearInterval(spinInterval);

        // Final selection is made here
        const finalStationObject = getRandomStation(stationsPool);
        const finalStationName = finalStationObject.name;

        // Update the display for the current spin slot
        resultElement.textContent = `🎯 ${finalStationName}`;

        // Store the result object (name and lines)
        finalResults[spinNumber] = finalStationObject;

        // Re-enable all spin buttons
        document.querySelectorAll('button').forEach(btn => btn.disabled = false);
        button.textContent = 'Spin again';

        // Check if all three spins are done to display final list
        if (Object.keys(finalResults).length === 3) {
          displayFinalStations();
        }

      }, 1500); // 1.5 seconds spin time
    }

    function getLineTagsHTML(lines) {
      return lines.map(line => `<span class="line-tag ${line.replace(/\s/g, '').replace('&', '')}">${line.replace('City', '& City')}</span>`).join('');
    }

    function displayFinalStations() {
      const container = document.getElementById('final-stations');
      container.innerHTML = '<h3>Where would you like to go?</h3>';

      // Iterate over the results (1, 2, 3)
      for (let i = 1; i <= 3; i++) {
        const stationObject = finalResults[i];
        if (stationObject) {
          const stationDiv = document.createElement('div');
          stationDiv.className = 'final-station-item';

          const lineTags = getLineTagsHTML(stationObject.lines);

          stationDiv.innerHTML = `
                        <strong>Option ${i}: ${stationObject.name}</strong> 
                        <div style="font-size: 0.9em; margin-top: 5px;">${lineTags}</div>
                    `;

          // Store the full object as a stringified attribute
          stationDiv.setAttribute('data-station-object', JSON.stringify(stationObject));
          stationDiv.setAttribute('onclick', 'chooseStation(this)');
          container.appendChild(stationDiv);
        }
      }
    }

    function chooseStation(element) {
      const stationObject = JSON.parse(element.getAttribute('data-station-object'));
      const infoBox = document.getElementById('chosen-station-info');

      // --- 1. Highlight the Chosen Station ---
      document.querySelectorAll('.final-station-item').forEach(item => {
        item.classList.remove('chosen');
        item.style.backgroundColor = '#FFFFFF';
        item.style.color = '#003366';
      });
      element.classList.add('chosen');

      const lineTags = getLineTagsHTML(stationObject.lines);
      const stationName = stationObject.name;

      // --- 2. Generate Dynamic Google Links ---
      const encodedQuery = encodeURIComponent(`${stationName} London`);

      const sightsLink = `https://www.google.com/search?q=top+sights+near+${encodedQuery}`;
      const cafesLink = `https://www.google.com/search?q=best+cafes+near+${encodedQuery}`;
      const mapsLink = `https://www.google.com/maps/search/?api=1&query=${encodedQuery}`;

      // --- 3. Update the Info Box with Lines and Links ---
      infoBox.innerHTML = `
                <h3>${stationName}</h3>
                <p>The lines serving this station are:</p>
                <div class="lines-list">
                    ${lineTags}
                </div>
                
                <div class="quick-links">
                    <h4>Quick links</h4>
                    <p>
                        <a href="${sightsLink}" target="_blank">🔍 Sights & Attractions</a> |
                        <a href="${cafesLink}" target="_blank">☕ Best Cafes & Food</a> |
                        <a href="${mapsLink}" target="_blank">🗺️ View on Google Maps</a>
                    </p>
                </div>

                <p style="margin-top: 15px;">Time to plan your trip and explore the area around <b>${stationName}</b>!</p>
            `;
    }

    // Initialize the display on load
    window.onload = updateSelectedZonesDisplay;
  </script>
</body>

</html>
